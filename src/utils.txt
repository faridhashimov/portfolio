import { useCallback, useContext, useEffect, useState } from 'react'
import { FaRegMoon } from 'react-icons/fa'
import { FiSun } from 'react-icons/fi'
import { ThemeContext } from '../../context/themeContext'
import './Navbar.scss'

const Navbar = () => {
    const [hidden, setHidden] = useState(false)
    const theme = useContext(ThemeContext)
    const darkMode = theme.state.darkMode
    const { dispatch } = useContext(ThemeContext)

    const onToggleMode = () => {
        dispatch({ type: 'TOGGLE' })
        console.log('Ok')
    }

    const StyledLink = ({ link, children }) => {
        return (
            <a
                style={{
                    color: darkMode ? '#fff' : '#222',
                    '&:hover': {
                        color: '#fff',
                    },
                }}
                href={link}
            >
                {children}
            </a>
        )
    }

    const show = {
        position: 'sticky',
        top: 0,
        transform: hidden ? 'translateY(-80px)' : 'translateY(0px)',
        zIndex: 10000,
        backdropFilter: 'blur(8px) saturate(180%)',
        transition: 'all .3s ease',
        backgroundColor: darkMode
            ? 'rgba(29, 53, 87, 0.75)'
            : 'rgba(255, 245, 238, 0.75)',
    }

    var lastScroll = 0
    window.onscroll = function (e) {
        var scrollY = window.pageYOffset || document.documentElement.scrollTop
        // var header = document.querySelector('header')

        console.log('scrollY:', scrollY, 'lastScroll:', lastScroll)
        scrollY <= lastScroll ? setHidden(false) : setHidden(true)

        lastScroll = scrollY
    }

    return (
        <div style={show} className="navbar">
            <div className="navbar-container">
                <div className="navbar-container__logo">fh</div>
                <nav className="navbar-container__list">
                    <StyledLink link={'#about'}>About</StyledLink>
                    <StyledLink link={'#skills'}>Skills</StyledLink>
                    <StyledLink link={'#projects'}>Projects</StyledLink>
                    <StyledLink link={'#contact'}>Contact</StyledLink>
                    <a
                        style={{
                            color: darkMode ? 'white' : '#A8DADC',
                            borderColor: darkMode ? 'white' : '#A8DADC',
                        }}
                        className="resume"
                        href="https://google.ru"
                    >
                        Resume
                    </a>
                </nav>

                <div
                    onClick={onToggleMode}
                    className={
                        darkMode
                            ? 'navbar-container__darkmode'
                            : 'navbar-container__lightmode'
                    }
                >
                    {darkMode ? <FiSun /> : <FaRegMoon />}
                </div>
            </div>
        </div>
    )
}

export default Navbar
